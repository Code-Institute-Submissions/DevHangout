<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Developers Hangout</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/laravel.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">Developers Hangout</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search">
</div>
            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content injectable">
                   <div class="content-data">







<ol class="breadcrumb">
  <li>Injectables</li>
  <li>AuthService</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/shared/services/auth/auth.service.ts</code>
        </p>



            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#API_URL">API_URL</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#currentUser">currentUser</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#helper">helper</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#jwtHelper">jwtHelper</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#refreshToken$">refreshToken$</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#refreshTokenSubject">refreshTokenSubject</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#router">router</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#username">username</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#checkConnection">checkConnection</a>
                            </li>
                            <li>
                                <a href="#getUser">getUser</a>
                            </li>
                            <li>
                                <a href="#isLoggedIn">isLoggedIn</a>
                            </li>
                            <li>
                                <a href="#login">login</a>
                            </li>
                            <li>
                                <a href="#logout">logout</a>
                            </li>
                            <li>
                                <a href="#notLoggedIn">notLoggedIn</a>
                            </li>
                            <li>
                                <a href="#refreshToken">refreshToken</a>
                            </li>
                            <li>
                                <a href="#register">register</a>
                            </li>
                            <li>
                                <a href="#sessionExpired">sessionExpired</a>
                            </li>
                            <li>
                                <a href="#setUserID">setUserID</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section>
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(http: <a href="https://angular.io/api/common/http/HttpClient" target="_blank">HttpClient</a>, jwtHelper: JwtHelperService, router: <a href="https://angular.io/api/router/Router" target="_blank">Router</a>, spinner: NgxSpinnerService, notify: NotificationsService)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="24" class="link-to-prism">src/app/shared/services/auth/auth.service.ts:24</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>http</td>
                                                  
                                                        <td>
                                                                    <code><a href="https://angular.io/api/common/http/HttpClient" target="_blank" >HttpClient</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>jwtHelper</td>
                                                  
                                                        <td>
                                                                    <code>JwtHelperService</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>router</td>
                                                  
                                                        <td>
                                                                    <code><a href="https://angular.io/api/router/Router" target="_blank" >Router</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>spinner</td>
                                                  
                                                        <td>
                                                                    <code>NgxSpinnerService</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>notify</td>
                                                  
                                                        <td>
                                                                    <code>NotificationsService</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section>
    
        <h3 id="methods">
            Methods
        </h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="checkConnection"></a>
                        <span class="name">
                            <b>
                            checkConnection
                            </b>
                            <a href="#checkConnection"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
<code>checkConnection()</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="45" class="link-to-prism">src/app/shared/services/auth/auth.service.ts:45</a></div>
                            </td>
                        </tr>


                <tr>
                    <td class="col-md-4">
                            <div class="io-description"><p>This is to check the connection to heroku, as it can be sleeping.
it will only return a list of all users not used anywhere, but if we get the list we know the server is live and we can proceed.</p>
</div>

                            <div class="io-description">
                                <b>Returns : </b>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="getUser"></a>
                        <span class="name">
                            <b>
                            getUser
                            </b>
                            <a href="#getUser"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
<code>getUser(id: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>)</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="61" class="link-to-prism">src/app/shared/services/auth/auth.service.ts:61</a></div>
                            </td>
                        </tr>


                <tr>
                    <td class="col-md-4">
                            <div class="io-description"><p>This will get the object used for the single user.</p>
</div>

                            <div class="io-description">
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                                    <td>Description</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>id</td>
                                                        <td>
                                                                    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                                        </td>
                                                    
                                                    <td>
                                                            No
                                                    </td>
                                                    

                                                        <td>
                                                                <code><p>This is the user ID for that specific user.</p>
</code>
                                                        </td>
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                            <div>
                            </div>
                            <div class="io-description">
                                <b>Returns : </b>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                            </div>
                                <div class="io-description">
                                    <p>the specific user object</p>

                                </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="isLoggedIn"></a>
                        <span class="name">
                            <b>
                            isLoggedIn
                            </b>
                            <a href="#isLoggedIn"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
<code>isLoggedIn()</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="200" class="link-to-prism">src/app/shared/services/auth/auth.service.ts:200</a></div>
                            </td>
                        </tr>


                <tr>
                    <td class="col-md-4">
                            <div class="io-description"><p>Helperfunction to check if user is logged in.
This will then check the localStorage for the token and decode it</p>
</div>

                            <div>
                            </div>
                            <div class="io-description">
                                <b>Returns : </b>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                            </div>
                                <div class="io-description">
                                    <p>a decoded token</p>

                                </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="login"></a>
                        <span class="name">
                            <b>
                            login
                            </b>
                            <a href="#login"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
<code>login(credentials: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>)</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="80" class="link-to-prism">src/app/shared/services/auth/auth.service.ts:80</a></div>
                            </td>
                        </tr>


                <tr>
                    <td class="col-md-4">
                            <div class="io-description"><p>This is the login function that will fetch and store the token.</p>
</div>

                            <div class="io-description">
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>credentials</td>
                                                        <td>
                                                                    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                                        </td>
                                                    
                                                    <td>
                                                            No
                                                    </td>
                                                    

                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                            <div>
                            </div>
                            <div class="io-description">
                                <b>Returns : </b>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                            </div>
                                <div class="io-description">
                                    <p>a JWT token
If we have an error we will show the error to the user.</p>

                                </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="logout"></a>
                        <span class="name">
                            <b>
                            logout
                            </b>
                            <a href="#logout"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
<code>logout()</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="159" class="link-to-prism">src/app/shared/services/auth/auth.service.ts:159</a></div>
                            </td>
                        </tr>


                <tr>
                    <td class="col-md-4">
                            <div class="io-description"><p>This will log out the user navigate them to the front page and clear localStorage.
It will also set the currentUser to null as we currently don&#39;t have any user at this moment.</p>
</div>

                            <div class="io-description">
                                <b>Returns : </b>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="notLoggedIn"></a>
                        <span class="name">
                            <b>
                            notLoggedIn
                            </b>
                            <a href="#notLoggedIn"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
<code>notLoggedIn()</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="186" class="link-to-prism">src/app/shared/services/auth/auth.service.ts:186</a></div>
                            </td>
                        </tr>


                <tr>
                    <td class="col-md-4">
                            <div class="io-description"><p>This will navigate the user to the front page, clear the localStorage
This will also set the currentUser to null as we do not have a valid user logge din.
Also sends a notification to the user that they need to be logged in.</p>
</div>

                            <div class="io-description">
                                <b>Returns : </b>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="refreshToken"></a>
                        <span class="name">
                            <b>
                            refreshToken
                            </b>
                            <a href="#refreshToken"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
<code>refreshToken()</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="214" class="link-to-prism">src/app/shared/services/auth/auth.service.ts:214</a></div>
                            </td>
                        </tr>


                <tr>
                    <td class="col-md-4">
                            <div class="io-description"><p>This will make a post request to the backend with the refresh token.
If this is validated it will store the new token in localStorage.
If it has an error we will hide the loading spinner, try to refresh the token again.
Also perfoming a check if the the status is 401 we know the session is expired as that would be unauhtorized.
While if its 400 we know they are not authenticated at all and will run notLoggedIn()</p>
</div>

                            <div>
                            </div>
                            <div class="io-description">
                                <b>Returns : </b>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                            </div>
                                <div class="io-description">
                                    <p>a token response</p>

                                </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="register"></a>
                        <span class="name">
                            <b>
                            register
                            </b>
                            <a href="#register"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
<code>register(user: <a href="../interfaces/User.html">User</a>)</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="122" class="link-to-prism">src/app/shared/services/auth/auth.service.ts:122</a></div>
                            </td>
                        </tr>


                <tr>
                    <td class="col-md-4">
                            <div class="io-description"><p>This is the registration function that will register a user to the backend.</p>
</div>

                            <div class="io-description">
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>user</td>
                                                        <td>
                                                                    <code><a href="../interfaces/User.html" target="_self" >User</a></code>
                                                        </td>
                                                    
                                                    <td>
                                                            No
                                                    </td>
                                                    

                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                            <div>
                            </div>
                            <div class="io-description">
                                <b>Returns : </b>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                            </div>
                                <div class="io-description">
                                    <p>true or false, and then sets a localStorage variable since this will be their first visit.</p>

                                </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="sessionExpired"></a>
                        <span class="name">
                            <b>
                            sessionExpired
                            </b>
                            <a href="#sessionExpired"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
<code>sessionExpired()</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="173" class="link-to-prism">src/app/shared/services/auth/auth.service.ts:173</a></div>
                            </td>
                        </tr>


                <tr>
                    <td class="col-md-4">
                            <div class="io-description"><p>This will navigate the user to the front page, clear the localStorage
This will also set the currentUser to null as we do not have a valid user logge din.
Also sends a notification to the user that their session has expired.</p>
</div>

                            <div class="io-description">
                                <b>Returns : </b>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="setUserID"></a>
                        <span class="name">
                            <b>
                            setUserID
                            </b>
                            <a href="#setUserID"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
<code>setUserID(userToken: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>)</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="111" class="link-to-prism">src/app/shared/services/auth/auth.service.ts:111</a></div>
                            </td>
                        </tr>


                <tr>
                    <td class="col-md-4">
                            <div class="io-description"><p>This sets the UserID into localStorage.</p>
</div>

                            <div class="io-description">
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>userToken</td>
                                                        <td>
                                                                    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                                        </td>
                                                    
                                                    <td>
                                                            No
                                                    </td>
                                                    

                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                            <div>
                            </div>
                            <div class="io-description">
                                <b>Returns : </b>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                            </div>
                                <div class="io-description">
                                    
                                </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section>
    
        <h3 id="inputs">
            Properties
        </h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="API_URL"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Private</span>
                            API_URL
                            </b>
                            <a href="#API_URL"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span><code>API_URL:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>environment.api_url</code>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="24" class="link-to-prism">src/app/shared/services/auth/auth.service.ts:24</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="currentUser"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            currentUser
                            </b>
                            <a href="#currentUser"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span><code>currentUser:     <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="19" class="link-to-prism">src/app/shared/services/auth/auth.service.ts:19</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="helper"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            helper
                            </b>
                            <a href="#helper"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span><code>helper:     <code></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>new JwtHelperService()</code>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="21" class="link-to-prism">src/app/shared/services/auth/auth.service.ts:21</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="jwtHelper"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            jwtHelper
                            </b>
                            <a href="#jwtHelper"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span><code>jwtHelper:     <code>JwtHelperService</code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code>JwtHelperService</code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="28" class="link-to-prism">src/app/shared/services/auth/auth.service.ts:28</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="refreshToken$"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            refreshToken$
                            </b>
                            <a href="#refreshToken$"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span><code>refreshToken$:     <code></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>this.refreshTokenSubject.asObservable()</code>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="23" class="link-to-prism">src/app/shared/services/auth/auth.service.ts:23</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="refreshTokenSubject"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Private</span>
                            refreshTokenSubject
                            </b>
                            <a href="#refreshTokenSubject"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span><code>refreshTokenSubject:     <code>BehaviorSubject&lt;boolean&gt;</code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code>BehaviorSubject&lt;boolean&gt;</code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>new BehaviorSubject&lt;boolean&gt;(false)</code>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="22" class="link-to-prism">src/app/shared/services/auth/auth.service.ts:22</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="router"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            router
                            </b>
                            <a href="#router"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span><code>router:     <code><a href="https://angular.io/api/router/Router" target="_blank" >Router</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://angular.io/api/router/Router" target="_blank" >Router</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="29" class="link-to-prism">src/app/shared/services/auth/auth.service.ts:29</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="username"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            username
                            </b>
                            <a href="#username"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <span class="modifier-icon icon ion-ios-reset"></span><code>username:     <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="20" class="link-to-prism">src/app/shared/services/auth/auth.service.ts:20</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
</section>

    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { User } from &quot;../../models/users.model&quot;;
import { Injectable } from &quot;@angular/core&quot;;
import { HttpClient } from &quot;@angular/common/http&quot;;
import { JwtHelperService } from &quot;@auth0/angular-jwt&quot;;
import { map } from &quot;rxjs/operators&quot;;
import &quot;rxjs/add/operator/catch&quot;;
import { Token } from &quot;../../models/token.model&quot;;
import { Router } from &quot;@angular/router&quot;;
import { NotificationsService } from &quot;angular2-notifications&quot;;
import { NgxSpinnerService } from &quot;ngx-spinner&quot;;
import { throwError, BehaviorSubject, } from &quot;rxjs&quot;;
import { environment } from &quot;../../../../environments/environment&quot;;

@Injectable({
	providedIn: &quot;root&quot;
})
export class AuthService {

	public currentUser: any;
	public username: string;
	public helper &#x3D; new JwtHelperService();
	private refreshTokenSubject: BehaviorSubject&lt;boolean&gt; &#x3D; new BehaviorSubject&lt;boolean&gt;(false);
	public refreshToken$ &#x3D; this.refreshTokenSubject.asObservable();
	private API_URL: string &#x3D; environment.api_url;

	constructor(
		private http: HttpClient,
		public jwtHelper: JwtHelperService,
		public router: Router,
		private spinner: NgxSpinnerService,
		private notify: NotificationsService
	) {
		const token &#x3D; localStorage.getItem(&quot;access&quot;);
		if (token) {
			this.currentUser &#x3D; this.helper.decodeToken(token);
		}
	}

	/**
	 *
	 * This is to check the connection to heroku, as it can be sleeping.
	 * it will only return a list of all users not used anywhere, but if we get the list we know the server is live and we can proceed.
	 * @memberof AuthService
	 */
	checkConnection() {
		return this.http
			.get(this.API_URL + &quot;/api/users/&quot;)
			.pipe(map((data: any) &#x3D;&gt; data))
			.catch((error: any) &#x3D;&gt; {
				return throwError(error);
			});
	}

	/**
	 *
	 * This will get the object used for the single user.
	 * @param{id} id This is the user ID for that specific user.
	 * @returns the specific user object
	 * @memberof AuthService
	 */
	getUser(id: any) {
		return this.http
			.get(this.API_URL + &quot;/api/users/&quot; + id + &quot;/&quot;)
			.pipe(map((data: any) &#x3D;&gt; data))
			.catch((error: any) &#x3D;&gt; {
				this.refreshToken();
				this.spinner.hide();
				return throwError(error);
			});
	}

	/**
	 *
	 * This is the login function that will fetch and store the token.
	 * @param(credentials) - The username and password of the user
	 * @returns a JWT token
	 * If we have an error we will show the error to the user.
	 * @memberof AuthService
	 */
	login(credentials: any) {
		localStorage.setItem(&quot;username&quot;, credentials.username);
		return this.http
			.post&lt;Token&gt;(this.API_URL + &quot;/api/token/&quot;, credentials)
			.pipe(
				map(response &#x3D;&gt; {
					const result &#x3D; response;
					if (result &amp;&amp; result.access) {
						localStorage.setItem(&quot;token&quot;, result.access);
						localStorage.setItem(&quot;refresh&quot;, result.refresh);
						this.currentUser &#x3D; this.helper.decodeToken(localStorage.getItem(&quot;token&quot;));
						this.setUserID(this.currentUser);
						this.refreshTokenSubject.next(true);
						return true;
					} else {
						return false;
					}
				})
			)
			.catch((error: any) &#x3D;&gt; {
				console.log(error);
				return throwError(this.notify.error(error.message) || &quot;Server Error&quot;);
			});
	}

	/**
	 *
	 * This sets the UserID into localStorage.
	 * @param(userToken) - The token that the user has
	 * @memberof AuthService
	 */
	setUserID(userToken: any) {
		localStorage.setItem(&quot;user_id&quot;, userToken.user_id);
	}

	/**
	 *
	 * This is the registration function that will register a user to the backend.
	 * @param(user) The User form that contains the username, password and email for that user.
	 * @returns true or false, and then sets a localStorage variable since this will be their first visit.
	 * @memberof AuthService
	 */
	register(user: User) {
		this.spinner.show();
		this.username &#x3D; user.username;
		const data &#x3D; {
			username: user.username,
			email: user.email,
			password: user.password
		};
		return this.http
			.post&lt;User&gt;(this.API_URL + &quot;/api/register/&quot;, data)
			.pipe(
				map(response &#x3D;&gt; {
					const result &#x3D; response;
					if (result) {
						sessionStorage.setItem(&quot;firstVisit&quot;, &quot;true&quot;);
						this.spinner.hide();
						this.notify.success(&quot;Welcome &quot; + user.username + &quot;. You can now log in&quot;);
						return true;
					} else {
						this.spinner.hide();
						return false;
					}
				})
			)
			.catch((error: any) &#x3D;&gt; {
				console.log(error);
				this.spinner.hide();
				return throwError(this.notify.error(&quot;The username already exists&quot;) || &quot;Server Error&quot;);
			});
	}

	/**
	 *
	 * This will log out the user navigate them to the front page and clear localStorage.
	 * It will also set the currentUser to null as we currently don&#x27;t have any user at this moment.
	 * @memberof AuthService
	 */
	logout() {
		this.router.navigate([&quot;/&quot;]);
		this.notify.info(&quot;Your now logged out&quot;);
		localStorage.clear();
		this.currentUser &#x3D; null;
	}

	/**
	 *
	 * This will navigate the user to the front page, clear the localStorage
	 * This will also set the currentUser to null as we do not have a valid user logge din.
	 * Also sends a notification to the user that their session has expired.
	 * @memberof AuthService
	 */
	sessionExpired() {
		this.router.navigate([&quot;/&quot;]);
		this.notify.info(&quot;Your session expired, please log back in&quot;);
		localStorage.clear();
		this.currentUser &#x3D; null;
	}

	/**
	 * This will navigate the user to the front page, clear the localStorage
	 * This will also set the currentUser to null as we do not have a valid user logge din.
	 * Also sends a notification to the user that they need to be logged in.
	 * @memberof AuthService
	 */
	notLoggedIn() {
		this.router.navigate([&quot;/&quot;]);
		this.notify.info(&quot;You need to be logged in&quot;);
		localStorage.clear();
		this.currentUser &#x3D; null;
	}

	/**
	 *
	 * Helperfunction to check if user is logged in.
	 * This will then check the localStorage for the token and decode it
	 * @returns a decoded token
	 * @memberof AuthService
	 */
	isLoggedIn() {
		return this.helper.decodeToken(localStorage.getItem(&quot;token&quot;));
	}

	/**
	 *
	 *  This will make a post request to the backend with the refresh token.
	 * If this is validated it will store the new token in localStorage.
	 * If it has an error we will hide the loading spinner, try to refresh the token again.
	 * Also perfoming a check if the the status is 401 we know the session is expired as that would be unauhtorized.
	 * While if its 400 we know they are not authenticated at all and will run notLoggedIn()
	 * @returns a token response
	 * @memberof AuthService
	 */
	refreshToken() {
		const Rtoken &#x3D; localStorage.getItem(&quot;refresh&quot;);
		return this.http
			.post&lt;Token&gt;(this.API_URL + &quot;/api/token/refresh/&quot;, { refresh: Rtoken })
			.pipe(
				map(response &#x3D;&gt; {
					localStorage.setItem(&quot;token&quot;, response.access);
					this.refreshTokenSubject.next(true);
				})
			)
			.catch((error: any) &#x3D;&gt; {
				this.refreshToken();
				this.spinner.hide();
				if (error.status &#x3D;&#x3D;&#x3D; 401) {
					this.sessionExpired();
				} else if (error.status &#x3D;&#x3D;&#x3D; 400) {
					this.notLoggedIn();
				} else {
					return throwError(this.notify.error(error.error.non_field_errors) || &quot;Server Error&quot;);
				}
			});
	}
}
</code></pre>
    </div>

</div>











                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'injectable';
            var COMPODOC_CURRENT_PAGE_URL = 'AuthService.html';
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <script src="../js/menu-wc.js"></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
